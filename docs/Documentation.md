Документация
Архитектура
Система онлайн-заказа цветов реализована по клиент-серверной многоуровневой архитектуре.
Уровни системы:
1. Уровень представления (UI) — веб-интерфейс пользователя и администратора.
2. Уровень прикладной логики — реализация бизнес-правил и обработка запросов.
3. Уровень хранения данных — реляционная база данных PostgreSQL.

Порядок взаимодействия компонентов:
1. Пользователь выполняет действие в UI.
2. UI формирует и отправляет REST-запрос в backend.
3. Контроллер вызывает соответствующий сервис.
4. Сервис обращается к базе данных.
5. Результат возвращается в UI и отображается пользователю.

Состав данных в БД:
- products - товары и изображения;
- orders, order_items - заказы и позиции заказа;
- users - администраторы;
- callback_requests - заявки на звонок.

Реализация:
- Контроллеры API: `website/backend/src/main/java/com/flowershop/controller/`
- Сервисы: `website/backend/src/main/java/com/flowershop/service/`
- Модели БД: `website/database/src/main/java/com/flowershop/model/`
- SQL-схема: `website/database/sql/02_create_tables.sql`
- Схема БД (DBML): `website/database/diagrams/database-schema.dbml`
- Схемы взаимодействия: `website/schemas/`
- Конфигурация приложения: `website/backend/src/main/resources/application.properties`
- Конфигурация логов: `website/backend/src/main/resources/logback-spring.xml`

Сервисы и алгоритмы
Сервисы прикладной логики:
1. ProductService — управление каталогом: получение списка, создание и удаление товаров.
   - ProductService работает с таблицей `products` (товары и поле `image`).
   - Основные операции: получить список, получить товар по id, создать товар, удалить товар.
2. OrderService — оформление заказов и расчёт итоговой суммы.
   - OrderService работает с таблицами `orders`, `order_items`.
   - Основные операции: создать заказ, получить список заказов.
3. AdminService — аутентификация администратора, управление статусами заказов, заявками и администраторами.
   - AdminService работает с таблицами `users`, `callback_requests`.
   - Основные операции: вход, создание/удаление админов, смена статусов, обработка заявок.

Алгоритмы (ключевые сценарии):
1. Оформление заказа:
   - заполнение формы клиентом;
   - отправка заказа в backend;
   - создание заказа и позиций;
   - установка статуса NEW;
   - запись в БД и логирование события.
2. Обработка заказа администратором:
   - авторизация администратора;
   - смена статуса: NEW → IN_PROCESS → DELIVERING → COMPLETED;
   - сохранение изменений в БД и логирование.
3. Заявка на звонок:
   - отправка имени и телефона клиентом;
   - сохранение заявки в БД;
   - отметка администратором как выполненной.
4. Управление товарами:
   - добавление товара (название, цена, описание, фото);
   - сохранение в БД;
   - удаление товара администратором.
5. Работа с админ-аккаунтами:
   - создание администратора;
   - удаление администратора;
   - авторизация по email/паролю.

Ограничения и правила:
- Клиенты оформляют заказ без аккаунта.
- Роли пользователей в БД — только ADMIN.
- Остатки товара не ведутся (количество не ограничено).
- Фото товара хранится как URL или PNG в base64 (поле `products.image`).
- Статусы заказа: NEW, IN_PROCESS, DELIVERING, COMPLETED, CANCELLED.
- Валидация: название товара обязательно, цена не ниже 0.

Логирование:
- Файл логов backend: `website/logs/flowershop.log`
- В логах фиксируются: вход в админку, действия админа, создание заказов, смена статусов, заявки на звонок.
- Логи пишутся с уровня INFO, без отладочного спама.

UI
Пользовательский интерфейс реализован как единый сайт с публичной частью и админ-панелью.
Основные функции UI:
- просмотр каталога;
- корзина и оформление заказа;
- форма «перезвоните мне»;
- админ-панель для обработки заказов, заявок и управления товарами.

Экраны:
1. Главная — карточки товаров.
2. Корзина — изменение количества, удаление, итог.
3. Оформление заказа — имя, телефон, email, адрес.
4. Callback — имя и телефон.
5. Администраторская панель:
   - Заказы: список и смена статусов;
   - Заявки: новые и завершённые;
   - Товары: добавление и удаление, загрузка фото (URL или PNG).
   - Админы: добавление и удаление администраторов (через соответствующие эндпоинты).

Как UI связан с API:
- Каталог: `GET /api/products`
- Заказы: `POST /api/orders`
- Заявки на звонок: `POST /api/callback`
- Админ-операции: `/api/admin/*`
