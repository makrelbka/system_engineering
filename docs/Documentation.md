### 220 Архитектура
Система онлайн-заказа цветов реализована по клиент-серверной многоуровневой архитектуре.
Уровни системы:
1. Уровень представления (UI) — веб-интерфейс пользователя и администратора.
2. Уровень прикладной логики — реализация бизнес-правил и обработка запросов.
3. Уровень хранения данных — реляционная база PostgreSQL.

Порядок взаимодействия компонентов:
1. Пользователь выполняет действие в UI.
2. UI формирует и отправляет REST-запрос в backend.
3. Контроллер вызывает соответствующий сервис.
4. Сервис обращается к базе данных.
5. Результат возвращается в UI и отображается пользователю.

Состав данных в БД:
- products — товары и изображения;
- orders, order_items — заказы и позиции заказа;
- users — администраторы;
- callback_requests — заявки на звонок.

Где смотреть реализацию:
- Контроллеры API: `website/backend/src/main/java/com/flowershop/controller/`
- Сервисы: `website/backend/src/main/java/com/flowershop/service/`
- Модели БД: `website/database/src/main/java/com/flowershop/model/`
- SQL-схема: `website/database/sql/02_create_tables.sql`
- Схема БД (DBML): `website/database/diagrams/database-schema.dbml`
- Схемы взаимодействия: `website/schemas/`

### 230 Сервисы и алгоритмы
Сервисы прикладной логики:
1. ProductService — управление каталогом: получение списка, создание и удаление товаров.
2. OrderService — оформление заказов и расчёт итоговой суммы.
3. AdminService — аутентификация администратора, управление статусами заказов, заявками и администраторами.

Контроллеры:
- ProductController — выдача каталога.
- OrderController — создание заказов.
- CallbackController — создание заявок.
- AdminController — вход, заказы, заявки, товары, админы.

Алгоритмы (ключевые сценарии):
1. Оформление заказа:
   - заполнение формы клиентом;
   - отправка заказа в backend;
   - создание заказа и позиций;
   - установка статуса NEW;
   - запись в БД и логирование события.
2. Обработка заказа администратором:
   - авторизация администратора;
   - смена статуса: NEW → IN_PROCESS → DELIVERING → COMPLETED;
   - сохранение изменений в БД и логирование.
3. Заявка на звонок:
   - отправка имени и телефона клиентом;
   - сохранение заявки в БД;
   - отметка администратором как выполненной.
4. Управление товарами:
   - добавление товара (название, цена, описание, фото);
   - сохранение в БД;
   - удаление товара администратором.

Бизнес-ограничения и правила:
- Клиенты оформляют заказ без аккаунта.
- Роли пользователей в БД — только ADMIN.
- Остатки товара не ведутся (количество не ограничено).
- Фото товара хранится как URL или PNG в base64 (поле `products.image`).
- Статусы заказа: NEW, IN_PROCESS, DELIVERING, COMPLETED, CANCELLED.

Где смотреть детализацию:
- ProductService: `website/backend/src/main/java/com/flowershop/service/ProductService.java`
- OrderService: `website/backend/src/main/java/com/flowershop/service/OrderService.java`
- AdminService: `website/backend/src/main/java/com/flowershop/service/AdminService.java`
- Логирование: `website/backend/src/main/resources/logback-spring.xml`

### 240 UI
Пользовательский интерфейс реализован как единый сайт с публичной частью и админ-панелью.
Основные функции UI:
- просмотр каталога;
- корзина и оформление заказа;
- форма «перезвоните мне»;
- админ-панель для обработки заказов, заявок и управления товарами.

Экраны:
1. Главная — карточки товаров.
2. Корзина — изменение количества, удаление, итог.
3. Оформление заказа — имя, телефон, email, адрес.
4. Callback — имя и телефон.
5. Админка:
   - Заказы: список и смена статусов;
   - Заявки: новые и завершённые;
   - Товары: добавление и удаление, загрузка фото (URL или PNG).

Ключевые страницы и компоненты:
- Главная страница: `website/frontend/src/views/Home.vue`
- Оформление заказа: `website/frontend/src/views/Checkout.vue`
- Админка: `website/frontend/src/views/Admin.vue`
- Корзина (панель в шапке): `website/frontend/src/components/Header.vue`
- Карточки товара: `website/frontend/src/components/ProductCard.vue`
- Сетка каталога: `website/frontend/src/components/ProductGrid.vue`

Как UI связан с API:
- Каталог: `GET /api/products`
- Заказы: `POST /api/orders`
- Заявки на звонок: `POST /api/callback`
- Админ-операции: `/api/admin/*`

Если нужно сверить точные поля запросов/ответов, см. контроллеры backend.

### 250 Логирование
Журналирование ведётся в `website/logs/flowershop.log`. Фиксируются события:
- вход администратора и его действия;
- оформление заказов и смена статусов;
- создание и обработка заявок;
- добавление и удаление товаров.

Где искать причины ошибок:
- Логи backend: `website/logs/flowershop.log`
- Конфигурация логов: `website/backend/src/main/resources/logback-spring.xml`

### 260 Запуск и проверка
Запуск:
- `docker compose up -d --build` из `website/`

Проверка работы:
1. Открыть `http://localhost` и убедиться, что каталог загружается.
2. Оформить заказ и проверить появление записи в админке.
3. В админке проверить смену статусов заказа.
4. Проверить форму “перезвоните мне” и список заявок.
5. Добавить/удалить товар в админке и проверить отображение на главной.

Если требуется быстро найти настройки:
- Docker: `website/docker-compose.yml`
- Backend настройки: `website/backend/src/main/resources/application.properties`
- Frontend proxy (dev): `website/frontend/vite.config.js`
